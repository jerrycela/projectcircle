---
name: weekly-report-auto
description: |
  自動週會報告生成器 - 從 Slack 抓取原始訊息並彙整為標準格式週會報告。
  觸發關鍵字：周會報告、週會報告、weekly report、生成周會報告、產生周會報告
  完整流程：抓取 Slack 訊息 → 按部門彙整 → 生成報告文件
---

# 自動週會報告生成器我

<!-- NOTE: 此 skill 的預設頻道列表路徑（/Users/admin/Cursor/工作日誌部門頻道列表.md）
     為本機專屬路徑，在其他機器上不存在。
     使用前請更新「步驟 1」中的 `頻道列表文件路徑` 預設值，或在執行時手動提供路徑。 -->

完整自動化流程：從 Slack 頻道抓取原始工作回報訊息，並彙整為標準格式的各部門週會報告。

## 使用時機

當用戶說：
- "生成本週的周會報告"
- "幫我做周會報告，時間是 2/2 到 2/6"
- "從 Slack 抓取訊息並產生週會報告"
- "製作週會報告文件"

## 完整工作流程

### 階段一：準備與確認（步驟 1-2）

#### 步驟 1：確認輸入資訊

**必要資訊**：
1. 頻道列表文件路徑（預設：`/Users/admin/Cursor/工作日誌部門頻道列表.md`，本機專屬）
2. 報告日期範圍（例如：2026/2/2 ~ 2026/2/6）
3. 時區（預設：UTC+8）

**詢問用戶**：
```
生成週會報告需要以下資訊：
1. 報告日期範圍（例如：2026/2/2 ~ 2026/2/6）
2. 頻道列表文件路徑（預設：/Users/admin/Cursor/工作日誌部門頻道列表.md）
3. 是否需要生成 DOCX 文件？（預設：是）

請提供報告日期範圍：
```

#### 步驟 2：讀取頻道列表

使用 Read 工具讀取頻道列表文件，提取：
- 頻道 ID
- 部門名稱
- 特殊處理說明（如後端部門從前一月 20 號開始抓取）

**預設頻道列表**：
| 序號 | 部門名稱 | 頻道 ID |
|------|---------|---------|
| 1 | 企劃 | C06T60YQBA9 |
| 2 | 美術 | C06SUE5RYB1 |
| 3 | 前端 | C06TEBDLYHH |
| 4 | 後端 | C06TEDRDZB4 |
| 5 | SDK | C06SZUSNCDV |
| 6 | SRE | C06TEDGKTGB |
| 7 | QA | C06UDLZ3CQ5 |
| 8 | 在地化 | C06V50B4TQQ |
| 9 | 客服 | C06T01S9ALX |
| 10 | 營運/Data Team | C06UGFFJJ91 |
| 11 | 行銷 | C06UA3W6BEJ |

---

### 階段二：抓取 Slack 訊息（步驟 3-6）

#### 步驟 3：計算正確的 Unix Timestamp

**重要**：Slack API 使用 UTC 時間的 Unix timestamp

**轉換公式（UTC+8）**：
```javascript
// 本地時間轉 UTC
本地時間 YYYY/MM/DD 00:00:00 UTC+8
= UTC 時間 YYYY/MM/(DD-1) 16:00:00

// Unix timestamp 計算
1. 計算基準日 (YYYY-01-01 00:00:00 UTC) 的 timestamp
2. 加上經過的天數 × 86400 秒
3. 調整時區偏移（-8 小時 = -28800 秒）
```

**範例**：
- 2026/2/2 00:00:00 UTC+8 → oldest: 1769961600
- 2026/2/6 23:59:59 UTC+8 → latest: 1770393599

**驗證工具**：https://www.unixtimestamp.com/

#### 步驟 4：載入 Slack MCP 工具

```
使用 ToolSearch 載入：
- mcp__claude_ai_Slack__slack_read_channel
- mcp__claude_ai_Slack__slack_read_thread
```

#### 步驟 5：並行啟動 Agent 抓取訊息

**關鍵原則**：
- ✅ 每個頻道使用獨立的 agent
- ✅ 所有 agent 在同一個 message 中並行啟動
- ✅ 使用 Haiku 模型（快速且便宜）
- ✅ 每個 agent 包含完整執行指令

**Agent Prompt 模板**：
```
請抓取 Slack 頻道 {CHANNEL_ID}（{部門名稱}）的所有訊息，時間範圍：{START_DATE} 00:00 至 {END_DATE} 23:59 (UTC+8)

## 時間戳
- oldest: {OLDEST_TIMESTAMP}
- latest: {LATEST_TIMESTAMP}

## 執行步驟
1. 使用 mcp__claude_ai_Slack__slack_read_channel 抓取主頻道訊息
   - channel_id: {CHANNEL_ID}
   - oldest: "{OLDEST_TIMESTAMP}"
   - latest: "{LATEST_TIMESTAMP}"
   - limit: 100
   - response_format: "detailed"

2. 如有分頁，繼續抓取直到完整

3. 針對有回覆的訊息（reply_count > 0），使用 mcp__claude_ai_Slack__slack_read_thread 抓取串內訊息

4. 整理成原始格式輸出

請完整執行並回傳結果。
```

**並行執行**：在單一 message 中啟動 11 個 Task，每個對應一個頻道。

#### 步驟 6：收集原始訊息

等待所有 agent 完成，收集所有原始訊息數據。

---

### 階段三：彙整週會報告（步驟 7-9）

#### 步驟 7：按部門彙整與清理

**彙整原則**：
1. **去除重複**：同一人多天報告相同內容只保留一次
2. **合併相似**：相同專案/功能的工作合併描述
3. **過濾雜訊**：移除機器人提醒、閒聊、加入通知
4. **標準化描述**：統一使用「完成」「進行中」「持續進行」

**各部門彙整格式**：

##### 1 企劃部門
**分類方式**：按「功能模組/專案」分類

**格式**：
```markdown
**企劃部門**

**後台系統開發**
- **SDK 儲值優化**：持續進行文字表整理；調整規格書與文字表
- **前台優化**：持續進行會員中心介面優化

**SD 專案（超感穿梭）**
- 完成預約頁規格書、文字表
- 製作轉官網企劃書、FIGMA、規格書及文字表
```

**彙整規則**：
- 按模組/專案分組
- 常見分類：後台系統開發、前台優化、各專案（DC/KM/VK/SD）
- 使用粗體標註子分類
- 每項用 bullet point

---

##### 2 美術部門
**分類方式**：按「專案」分類，再按「工作類型」細分

**格式**：
```markdown
**美術部門**

**DC 專案（萬源聖魔錄）**
- **靜態與宣傳素材**：完成影片角色情報「楊紫芸」；完成卡池「百華啟年」多語系素材
- **影片**：完成角色情報「楊紫芸」

**KM 專案**
- **靜態與宣傳素材**：完成韓國 HowlSoup 明信片製作
- **影片**：完成角色情報「瑞卡諾」

**網頁及其他專案**
- **SDK 儲值**：進行儲值中心、派對卡福利、派對卡元件整理
```

**彙整規則**：
- 按專案分組：DC、KM、VK、SD、網頁及其他
- 每個專案按類型分：靜態與宣傳素材、影片、專案監修
- 提取素材編號、角色名稱、活動名稱
- 合併同類工作

---

##### 3 前端部門
**分類方式**：按「工作類型」分類

**格式**：
```markdown
**前端部門**

**開發與自動化**
- **AI 自動化與優化**：整理 Claude Skill 在地化方案
- **新春活動頁**：規劃頁面整體狀態並建立 Store

**前台網站開發**
- **SD 專案**：建立 SEO、更新開發環境變數
- **WebGL 美術修正**：持續進行 WebGL 美術修正 (WEB-62)

**其他**
- **系統維護**：Debug 處理 Cloudflare 操作問題
```

**彙整規則**：
- 分類：開發與自動化、前台網站開發、其他
- 保留 Jira 票號（如 WEB-62）
- 保留版本號（如 v1.0.0-rc.1）
- 合併同專案多個開發項目

---

##### 4 後端部門
**分類方式**：按「功能類型」分類

**格式**：
```markdown
**後端部門**

**平台功能開發**
- **金流實作**：持續進行平台金流功能實作
- 處理財務與客服需求
```

**彙整規則**：
- 簡潔描述主要功能開發
- 合併持續性工作
- 突出新功能開發和問題處理

---

##### 5 SDK 部門
**分類方式**：按「技術領域」分類

**格式**：
```markdown
**SDK 部門**

**技術研究與重構**
- **WebGL**：研究使用 Origin 進行保護；進行程式碼重構
```

**彙整規則**：
- 按技術領域分組
- 保留版本號
- 說明技術研究目的和進度

---

##### 6 SRE 部門
**分類方式**：按「工作類型」分類

**格式**：
```markdown
**SRE 部門**

**雲端平台管理**
- **每日費用查看**：每日查看 GCP 費用

**服務部署與維護**
- **VK 專案**：完成 VK Sandbox 建置
- **SD 專案**：完成 SD Prod 後台架設
- **監控與警報**：觀察 KM 警報；調整騰訊雲警報
- **平台更新**：執行平台更新及各專案更新
```

**彙整規則**：
- 分類：雲端平台管理、服務部署與維護
- 按專案列出部署/維護
- 包含環境類型（Sandbox/Prod/Stage）

---

##### 7 QA 部門
**分類方式**：按「專案」分類

**格式**：
```markdown
**QA 部門**

**專案測試**
- **DC 專案**：完成 12/30 更新內容及熱更測試
- **KM 專案**：完成 12/30 更新維護測試
- **VK 專案**：完成 12/30 新活動更新測試
- **SD 專案**：進行 SD Alpha 測試
```

**彙整規則**：
- 按專案分組
- 保留測試日期和類型
- 合併同專案多次測試

---

##### 8 在地化部門
**分類方式**：按「專案」分類，列出翻譯/驗證進度

**格式**：
```markdown
**在地化部門**

**DC**
- 0114翻譯單
- 瑞文技能 + 技能修改
- 各類社群公告信件
- 持續進行：宋明歌、克拉瑞莎

**XXL**
- 溫泉活動上半
- 各類社群公告信件
- 持續進行：林煜嶄

**VK**
- MasterData翻譯_251230
- 埃里克生日文本、卡面文本
- 持續進行：元宵節卡面文本

**SD**
- 日：SR角*6、SSR角*6 待驗證 (SSR: 0/7 | SR: 4/10)
- 英：SSR角*1、第一章 (SSR: 5/7 | SR: 10/10)
- 韓：尚未開始
```

**彙整規則**：
- 按專案分組
- 列出已完成翻譯項目
- 標註「持續進行」項目
- SD 專案按語系（日/英/韓）列出進度統計

---

##### 9 Data Team
**分類方式**：按「專案/功能」分類

**格式**：
```markdown
**Data Team**

**DC**
- 撈取 s5 最後一批的先鋒服
- 撈取每月 D30 留存、LTV

**KM**
- 自動化 DMM 雲遊玩對帳
- 優化工作室帳號判斷邏輯

**VK**
- 新增用戶存量儀表板
- 撈取用戶的遊戲語系

**財務**
- 訂單個案修改後確認
- 調整訂單月表篩選

**其他**
- 撈取其他遊戲營運數據
```

**彙整規則**：
- 按專案/功能分組
- 使用簡潔動詞開頭（撈取、新增、優化等）
- 保留技術細節（儀表板、API）

---

##### 10 客服部門
**分類方式**：特殊格式 - 專案案件處理 + 其他

**格式**：
```markdown
**客服部門**

### 專案相關案件處理
- **專案相關**：回覆處理 DC/KM/VK 各管道客訴（VIP/R18/R15/DMM/FB/X/雙端評論），週總處理件數約 673件；製作日報與週建議彙整。
- **PH 平台**：久昌詐騙點數用戶資料調查及帳號託管、申請用戶付款掉單回調
- **MEGA平台**：「雙端退款封鎖名單」用戶欠款追討
- **VIP**：大額儲值款項申請，共2筆總計6萬TWD

### 其他
- 持續優化客服內部表單相關公式及話術庫
- PAYUNi 補款商品上下架
```

**彙整規則**：
- **必須計算週總處理件數**（加總各日）
- 分為「專案相關案件處理」和「其他」
- 列出各平台特殊處理項目
- VIP 大額儲值需統計總金額

---

##### 11 營運部門
**分類方式**：按「工作類型」和「專案」混合

**格式**：
```markdown
**營運部門**

**社群與平台營運**
- **VK 專案**：發布維護公告
- **社群排程**：撰寫 KM 社群 2 月文案
- **工單管理**：開立 KM 日文社群文案在地化工單
- **廣告投放**：關閉 Discord 廣告

**DC專案**
- **活動維護**：排定新PU卡池公告
- **維護執行**：12/30更新流程執行

**KM專案**
- **12/30 更新流程**：開機/召喚公告設定、補償發送
- DMM 雲遊玩登入和儲值問題對應

**VK專案**
- **送審版本**：測試0108要送審的版本內容
- **商城調整**：設計新禮包
```

**彙整規則**：
- 先列「社群與平台營運」通用工作
- 再按專案分別列出
- 包含公告設定、版本更新、商城調整

---

##### 12 行銷部門
**分類方式**：按「專案」分類

**格式**：
```markdown
**行銷部門**

**DC 專案**
- **社群經營**：發布維護公告及日常社群維護

**KM 專案**
- **社群經營與發布**：發布 GAMESTAR 投票提醒
- **活動與文案規劃**：撰寫 KM 社群 2 月份推廣文案
- **素材與資源管理**：執行 SD 與 KM 專案素材需求溝通
- **外包繪師**：泰國繪師 Sollyz 進度追蹤

**VK 專案（時空心語）**
- **社群經營**：發布維護公告及日常社群維護

**廣告投放與其他**
- **廣告管理**：DC、KM、VK 廣告優化投放
- **年度預算**：計算 2025 專案支出、製表
```

**彙整規則**：
- 按專案分組
- 每個專案按類型細分
- 最後加「廣告投放與其他」
- 保留具體合作對象名稱

---

#### 步驟 8：生成報告文件

**報告結構**：
```markdown
各部門週會報告（{起始日期} ~ {結束日期}）
============================================

企劃部門
--------
[彙整內容]

美術部門
--------
[彙整內容]

前端部門
--------
[彙整內容]

後端部門
--------
[彙整內容]

SDK 部門
--------
[彙整內容]

SRE 部門
--------
[彙整內容]

QA 部門
--------
[彙整內容]

在地化部門
----------
[彙整內容]

Data Team
---------
[彙整內容]

客服部門
--------
[彙整內容]

營運部門
--------
[彙整內容]

行銷部門
--------
[彙整內容]
```

**格式規範**：
- 主標題：粗體，包含日期範圍
- 日期格式：`YYYY/MM/DD ~ YYYY/MM/DD`
- 部門標題：使用粗體 `**部門名稱**`
- 下方使用分隔線 `--------`
- 內容使用 bullet point (`-`)
- 子分類使用粗體：`**分類名稱**`

#### 步驟 9：保存檔案

**Markdown 版本**：
```
檔名：weekly_report_{START_YYYYMMDD}-{END_YYYYMMDD}.md
路徑：當前工作目錄
```

**DOCX 版本（可選）**：
如果用戶需要 DOCX 格式，詢問是否使用 docx skill 生成。

**DOCX 設定**：
- 紙張：A4
- 頁邊距：上下左右 2.54cm
- 標題：Arial 16pt 粗體
- 部門標題：Arial 14pt 粗體
- 內容：Arial 12pt
- 項目符號：縮排 720 DXA

---

## 完整執行範例

```python
# 用戶輸入
"生成 2026/2/2 到 2026/2/6 的週會報告"

# 執行流程
1. 確認日期範圍：2026/2/2 ~ 2026/2/6
2. 讀取頻道列表（11 個部門）
3. 計算時間戳：oldest=1769961600, latest=1770393599
4. 載入 Slack 工具
5. 並行啟動 11 個 agent 抓取訊息
6. 收集所有原始訊息
7. 按 12 個部門格式彙整
8. 生成報告文件
9. 保存為 weekly_report_20260202-20260206.md
10. （可選）生成 DOCX 版本
```

---

## 重要注意事項

### 時間戳計算
- **永遠使用正確的年份**（2026 ≠ 2025）
- **驗證時間戳**：使用 https://www.unixtimestamp.com/
- **特殊處理**：後端部門從前一月 20 號開始抓取

### 並行執行
- **單一 message** 啟動所有 agent
- **使用 Haiku** 模型（快速且便宜）
- **預期時間**：11 個頻道約 1-2 分鐘

### 資料清理
- **去重**：同一人多天相同內容
- **過濾**：機器人訊息、閒聊、通知
- **合併**：相似工作項目
- **標準化**：統一使用狀態詞

### 客服部門特殊處理
- **必須計算週總處理件數**
- 加總各日的 DC/KM/VK 處理件數
- 統計 VIP 大額儲值總金額

---

## 專案代碼對照表

| 代碼 | 專案名稱 | 英文名稱 |
|------|---------|---------|
| DC | 萬源聖魔錄 | Destiny Child |
| KM / XXL | 時空戀人 | King's Maker |
| VK | 時空心語 | Voice of Knight |
| SD | 超感穿梭 | Space Dive |
| PH | 平台 | PlayHorny |

---

## 常見問題

### Q1：時間範圍跨月怎麼辦？
A：正常處理，timestamp 會自動計算正確的跨月時間。

### Q2：某個頻道沒有訊息？
A：在報告中標註「本週無工作回報」。

### Q3：訊息格式不一致怎麼處理？
A：盡量提取關鍵資訊（專案、工作項目、狀態），統一格式化。

### Q4：需要包含週末嗎？
A：依照用戶指定的日期範圍，通常週會報告涵蓋週一到週五。

### Q5：生成失敗怎麼辦？
A：
1. 檢查時間戳是否正確
2. 檢查 Slack 工具是否載入
3. 檢查是否有頻道權限問題
4. 可以單獨測試單一頻道

---

## 檢查清單

**執行前**：
- [ ] 已確認報告日期範圍
- [ ] 已確認頻道列表文件路徑
- [ ] 已計算正確的 Unix timestamp
- [ ] 已載入 Slack MCP 工具

**執行中**：
- [ ] 所有 11 個 agent 都成功啟動
- [ ] 沒有 agent 回報錯誤
- [ ] 預估執行時間合理（1-2 分鐘）

**執行後**：
- [ ] 所有 12 個部門都有內容
- [ ] 客服部門已計算週總處理件數
- [ ] 專案代碼已轉換為中文名稱
- [ ] 報告格式符合規範
- [ ] 檔案已成功保存

---

**Skill 版本**：2.0
**最後更新**：2026-02-10
**整合模組**：fetch-slack-messages + weekly-report-generator
**適用場景**：自動化週會報告生成
